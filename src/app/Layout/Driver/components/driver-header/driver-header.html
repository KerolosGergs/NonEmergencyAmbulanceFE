<div class="driver-header position-relative overflow-hidden animate__animated animate__fadeIn">
  <!-- Background Gradient -->
  <div class="header-gradient position-absolute w-100 h-100"></div>

  <!-- Background Pattern -->
  <div class="header-pattern position-absolute w-100 h-100"></div>

  <div class="container-fluid position-relative">
    <div class="row align-items-center py-4 g-4">

      <!-- Profile Section -->
      <div class="col-12 col-lg-6">
        <div class="d-flex align-items-center gap-3">
          <!-- Avatar with Status -->
          <div class="position-relative">
            <img
              [src]="imgUrl || 'https://images.pexels.com/photos/5327585/pexels-photo-5327585.jpeg?auto=compress&cs=tinysrgb&w=150'"
              alt="Driver Profile"
              class="driver-avatar rounded-4 border border-3 border-white shadow-lg"
              [class.placeholder-glow]="loading()" />
            <span class="status-indicator position-absolute bg-success border border-3 border-white rounded-circle"></span>
          </div>

          <!-- Profile Info -->
          <div class="flex-grow-1 min-w-0">
            <div class="d-flex align-items-center gap-2 flex-wrap mb-1">
              <h4 class="mb-0 fw-bold text-white text-truncate" [class.placeholder]="loading()">
                {{ driverName }}
              </h4>

              @if (certification) {
                <span class="badge bg-white bg-opacity-20 backdrop-blur rounded-pill px-3 py-1 text-primary" [class.placeholder]="loading()">
                  {{ certification }}
                </span>
              }
            </div>

            <div class="d-flex align-items-center gap-3 text-white-50 small">
              @if (phoneNumber && !loading()) {
                <div class="d-flex align-items-center gap-1">
                  <i class="bi bi-telephone"></i>
                  <span>{{ phoneNumber }}</span>
                </div>
              }
              <div class="d-flex align-items-center gap-1">
                <i class="bi bi-person-badge"></i>
                <span>Driver ID: {{ driverId }}</span>
              </div>
              <div class="d-flex align-items-center gap-1">
                <i class="bi bi-calendar3"></i>
                <span>{{ today | date:'EEEE, MMM d' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions Section -->
      <div class="col-12 col-lg-6">
        <div class="d-flex align-items-center gap-3 justify-content-lg-end flex-wrap">

          <!-- Balance Display -->
          <div class="balance-card bg-white bg-opacity-10 backdrop-blur rounded-4 px-4 py-3 border border-white border-opacity-20">
            <div class="d-flex align-items-center gap-2">
              <i class="bi bi-wallet2 text-white fs-5"></i>
              <div>
                <small class="text-white-50 d-block">Balance</small>
                <div class="fw-bold text-white" [class.placeholder]="loading()">
                  {{ totalMoney | currency:'EGP':'symbol':'1.2-2' }}
                </div>
              </div>
            </div>
          </div>

          <!-- Withdraw Form -->
          <form [formGroup]="withdrawForm" (ngSubmit)="withdraw()" class="d-flex flex-column gap-2 withdraw-form">

            <!-- Amount Field + Button -->
            <div class="input-group input-group-sm withdraw-input">
              <input
                type="number"
                class="form-control bg-white bg-opacity-90 border-0"
                formControlName="amount"
                placeholder="Amount"
                [disabled]="loading()"
                step="0.01"
                min="0" />
              <button
                class="btn btn-light fw-semibold px-3"
                type="submit"
                [disabled]="loading() || withdrawForm.invalid">
                <i class="bi bi-cash-coin me-1"></i>
                {{ loading() ? 'Processing...' : 'Withdraw' }}
              </button>
            </div>

            <!-- Validation Message (Angular v20 @if requirement) -->
            <div class="form-group">
              @if (amountCtrl?.touched && amountCtrl?.invalid) {
                <span class="text-danger small">
                  Amount is required, must be at least 50 and not exceed your balance.
                </span>
              }
            </div>
          </form>

          <!-- Action Buttons -->
          <div class="d-flex gap-2">
            <button
              type="button"
              class="btn btn-danger btn-md bg-opacity-20 border-danger border-opacity-30"
              (click)="logout()">
              <i class="bi bi-box-arrow-right me-1"></i>
              Logout
            </button>
          </div>

        </div>
      </div>

    </div>
  </div>
</div>
