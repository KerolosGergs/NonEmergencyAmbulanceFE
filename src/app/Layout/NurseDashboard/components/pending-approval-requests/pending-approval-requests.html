<div class="p-3">
  <h5>Pending Approval Requests</h5>

<!-- Filter by Emergency Type -->
<div class="input-group mb-3">
  <input
    type="text"
    class="form-control"
    [(ngModel)]="searchTerm"
    placeholder="Search by name or ID..."
  />
  <select
    class="form-select ms-2"
    [(ngModel)]="selectedEmergencyType"
    style="max-width: 200px;"
  >
    <option value="">All Requests</option>
    <option value="Urgent">Urgent</option>
    <option value="Standard">Standard</option>
    <option value="Special Care">Special Care</option>
  </select>
  <span class="input-group-text">
    <i class="bi bi-search"></i>
  </span>
</div>


  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <thead>
        <tr>
          <th>Patient</th>
          <th>From</th>
          <th>To</th>
          <th>Date & Time</th>
          <th>Priority</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of paginatedRequests">
          <td>
            <img
              [src]="r.patientImageUrl"
              class="rounded-circle me-2"
              width="35"
              height="35"
            />
            <div>
              {{ r.patientName }}
              <div class="text-muted small">ID: {{ r.patientId }}</div>
            </div>
          </td>
          <td>{{ r.pickupAddress }}</td>
          <td>{{ r.dropOffAddress }}</td>
          <td>
            <div>{{ r.scheduledDate | date : "MMMM d, h.mm a" }}</div>
          </td>
          <td>
            <span
              class="fw-bold"
              [ngStyle]="getEmergencyStyle(r.emergencyType)"
            >
              {{ r.emergencyType }}
            </span>
          </td>
          <td>
            <button
              class="btn btn-sm me-1 "
              [ngClass]="{
                'btn-outline-primary': selectedRequestId === r.requestId,
                'btn-primary': selectedRequestId !== r.requestId
              }"
              (click)="selectRequest(r)"
            >
              View Details
            </button>
            <button
              class="btn btn-sm btn-success me-1"
              (click)="approveRequest(r)"
            >
              Approve
            </button>
            <button class="btn btn-sm btn-danger" (click)="declineRequest(r)">
              Decline
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <nav
    *ngIf="totalPages > 1"
    class="d-flex justify-content-between align-items-center"
  >
    <span
      >Showing {{ paginatedRequests.length }} of
      {{ filteredRequests.length }} requests</span
    >

    <div class="btn-group">
      <button
        class="btn btn-outline-secondary btn-sm"
        [disabled]="currentPage === 1"
        (click)="changePage(-1)"
      >
        <i class="bi bi-chevron-left"></i> Prev
      </button>
      <button
        class="btn btn-outline-secondary btn-sm"
        [disabled]="currentPage === totalPages"
        (click)="changePage(1)"
      >
        Next <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</div>
